## 更新版：要件定義書

上記評価を踏まえ、要件定義書を更新します。

1. プロジェクトのコアコンセプト
   このプロジェクトは、「AI による僧伽（サンガ）」を創り出す試みです。個性豊かな AI エージェントたちが、ひとつのチームとして協力し、仏教の智慧と現代社会を繋ぐ、心に響く「法話」というコンテンツを創造します。

プロジェクト名: 法話メーカー

目的: 駆け出し僧侶の創造的パートナーとなり、法話作成の負担を軽減し、質を高める。

ソリューション: テーマと聴衆を指定するだけで、AI チームが自律的に調査・執筆・評価を行い、最高の法話草稿を一つ提案する Web アプリ。

2. 機能：AI エージェントチームの共同作業
   2.1. エージェントの構成と役割
   5 人の専門エージェントが、最高の法話を創るために協業します。

① 方便エージェント : 戦略家
ユーザーの意図を読み解き、チーム全体の行動計画を立てる司令塔。経典検索用の「問い」と、時事ネタ検索用の「キーワード」を同時に生成する。

② 蔵主エージェント : 古典学者
経典の宇宙を探求するリサーチャー。「問い」を頼りに、法話の根拠となる経典の一節とその出典を見つけ出す。

③ 遊行僧エージェント : ジャーナリスト
現代社会を駆け巡るフィールドワーカー。「キーワード」と蔵主エージェントが見つけた経典を参考に、テーマに深く関連する時事ニュースを 5 つ収集する。

④ 作家エージェント : 5 人の物語の紡ぎ手
1 つの経典と 5 つの時事ネタを元に、5 通りの異なる法話草稿を並行して執筆するアーティストチーム。

⑤ 批評家エージェント : 評価者
5 つの法話草稿を、「論理の一貫性」「独自性」「感動」などの複数の評価項目に基づき厳格に審査し、最高得点の法話を一つだけ選出する。

2.2. 自律的な処理フロー
User Request
|
V
[① 方便エージェント] -> 戦略（仏教クエリ + 時事クエリ）を立案
|
V
[② 蔵主エージェント] -> 経典を検索 (結果: 経典 A)
|
V
[③ 遊行僧エージェント] -> 時事ニュースを 5 つ検索 (入力: 時事クエリ + 経典 A)
|
V
[④ 作家エージェント] -> 5 つの法話を並行生成 (入力: 経典 A + ニュース 1〜5)
|
V (5 つの法話草稿)
|
[⑤ 批評家エージェント] -> 評価とランキング
|
V (最も評価の高い法話 1 つ)
|
Final Output 3. システムのルール（非機能要件）
パフォーマンス: この設計は複数の LLM コールを伴うため、レスポンスには 30 秒〜60 秒以上かかる可能性があることを許容する。各エージェントの単体処理タイムアウトは 30 秒とする。

信頼性（エラーハンドリング）:

4. 技術とデータ仕様
   （API 仕様、メタデータ仕様などは前回定義通り）

5. 対象外
   ユーザー認証、ログイン機能

生成された法話の保存、履歴機能
